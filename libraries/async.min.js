/*!
 * async
 * https://github.com/caolan/async
 *
 * Copyright 2010-2014 Caolan McMahon
 * Released under the MIT license
 */
!function(){function n(n){var t=!1;return function(){if(t)throw Error("Callback was already called.");t=!0,n.apply(e,arguments)}}var e,t,r={};e=this,null!=e&&(t=e.async),r.noConflict=function(){return e.async=t,r};var o=Object.prototype.toString,i=Array.isArray||function(n){return"[object Array]"===o.call(n)},a=function(n,e){if(n.forEach)return n.forEach(e);for(var t=0;t<n.length;t+=1)e(n[t],t,n)},u=function(n,e){if(n.map)return n.map(e);var t=[];return a(n,function(n,r,o){t.push(e(n,r,o))}),t},c=function(n,e,t){return n.reduce?n.reduce(e,t):(a(n,function(n,r,o){t=e(t,n,r,o)}),t)},f=function(n){if(Object.keys)return Object.keys(n);var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push(t);return e};"undefined"!=typeof process&&process.nextTick?(r.nextTick=process.nextTick,r.setImmediate="undefined"!=typeof setImmediate?function(n){setImmediate(n)}:r.nextTick):"function"==typeof setImmediate?(r.nextTick=function(n){setImmediate(n)},r.setImmediate=r.nextTick):(r.nextTick=function(n){setTimeout(n,0)},r.setImmediate=r.nextTick),r.each=function(e,t,r){function o(n){n?(r(n),r=function(){}):(i+=1,i<e.length||r())}if(r=r||function(){},!e.length)return r();var i=0;a(e,function(e){t(e,n(o))})},r.forEach=r.each,r.eachSeries=function(n,e,t){if(t=t||function(){},!n.length)return t();var r=0,o=function(){e(n[r],function(e){e?(t(e),t=function(){}):(r+=1,r<n.length?o():t())})};o()},r.forEachSeries=r.eachSeries,r.eachLimit=function(n,e,t,r){var o=l(e);o.apply(null,[n,t,r])},r.forEachLimit=r.eachLimit;var l=function(n){return function(e,t,r){if(r=r||function(){},!e.length||0>=n)return r();var o=0,i=0,a=0;!function u(){if(o>=e.length)return r();for(;n>a&&i<e.length;)i+=1,a+=1,t(e[i-1],function(n){n?(r(n),r=function(){}):(o+=1,a-=1,o<e.length?u():r())})}()}},s=function(n){return function(){var e=Array.prototype.slice.call(arguments);return n.apply(null,[r.each].concat(e))}},p=function(n,e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[l(n)].concat(t))}},h=function(n){return function(){var e=Array.prototype.slice.call(arguments);return n.apply(null,[r.eachSeries].concat(e))}},m=function(n,e,t,r){if(e=u(e,function(n,e){return{index:e,value:n}}),r){var o=[];n(e,function(n,e){t(n.value,function(t,r){o[n.index]=r,e(t)})},function(n){r(n,o)})}else n(e,function(n,e){t(n.value,function(n){e(n)})})};r.map=s(m),r.mapSeries=h(m),r.mapLimit=function(n,e,t,r){return d(e)(n,t,r)};var d=function(n){return p(n,m)};r.reduce=function(n,e,t,o){r.eachSeries(n,function(n,r){t(e,n,function(n,t){e=t,r(n)})},function(n){o(n,e)})},r.inject=r.reduce,r.foldl=r.reduce,r.reduceRight=function(n,e,t,o){var i=u(n,function(n){return n}).reverse();r.reduce(i,e,t,o)},r.foldr=r.reduceRight;var y=function(n,e,t,r){var o=[];e=u(e,function(n,e){return{index:e,value:n}}),n(e,function(n,e){t(n.value,function(t){t&&o.push(n),e()})},function(){r(u(o.sort(function(n,e){return n.index-e.index}),function(n){return n.value}))})};r.filter=s(y),r.filterSeries=h(y),r.select=r.filter,r.selectSeries=r.filterSeries;var g=function(n,e,t,r){var o=[];e=u(e,function(n,e){return{index:e,value:n}}),n(e,function(n,e){t(n.value,function(t){t||o.push(n),e()})},function(){r(u(o.sort(function(n,e){return n.index-e.index}),function(n){return n.value}))})};r.reject=s(g),r.rejectSeries=h(g);var v=function(n,e,t,r){n(e,function(n,e){t(n,function(t){t?(r(n),r=function(){}):e()})},function(){r()})};r.detect=s(v),r.detectSeries=h(v),r.some=function(n,e,t){r.each(n,function(n,r){e(n,function(n){n&&(t(!0),t=function(){}),r()})},function(){t(!1)})},r.any=r.some,r.every=function(n,e,t){r.each(n,function(n,r){e(n,function(n){n||(t(!1),t=function(){}),r()})},function(){t(!0)})},r.all=r.every,r.sortBy=function(n,e,t){r.map(n,function(n,t){e(n,function(e,r){e?t(e):t(null,{value:n,criteria:r})})},function(n,e){if(n)return t(n);var r=function(n,e){var t=n.criteria,r=e.criteria;return r>t?-1:t>r?1:0};t(null,u(e.sort(r),function(n){return n.value}))})},r.auto=function(n,e){e=e||function(){};var t=f(n),o=t.length;if(!o)return e();var u={},l=[],s=function(n){l.unshift(n)},p=function(n){for(var e=0;e<l.length;e+=1)if(l[e]===n)return void l.splice(e,1)},h=function(){o--,a(l.slice(0),function(n){n()})};s(function(){if(!o){var n=e;e=function(){},n(null,u)}}),a(t,function(t){var o=i(n[t])?n[t]:[n[t]],l=function(n){var o=Array.prototype.slice.call(arguments,1);if(o.length>1||(o=o[0]),n){var i={};a(f(u),function(n){i[n]=u[n]}),i[t]=o,e(n,i),e=function(){}}else u[t]=o,r.setImmediate(h)},m=o.slice(0,Math.abs(o.length-1))||[],d=function(){return c(m,function(n,e){return n&&u.hasOwnProperty(e)},!0)&&!u.hasOwnProperty(t)};if(d())o[o.length-1](l,u);else{var y=function(){d()&&(p(y),o[o.length-1](l,u))};s(y)}})},r.retry=function(n,e,t){var o=5,i=[];"function"==typeof n&&(t=e,e=n,n=o),n=parseInt(n,10)||o;var a=function(o,a){for(var u=function(n,e){return function(t){n(function(n,r){t(!n||e,{err:n,result:r})},a)}};n;)i.push(u(e,!(n-=1)));r.series(i,function(n,e){e=e[e.length-1],(o||t)(e.err,e.result)})};return t?a():a},r.waterfall=function(n,e){if(e=e||function(){},!i(n)){var t=Error("First argument to waterfall must be an array of functions");return e(t)}if(!n.length)return e();var o=function(n){return function(t){if(t)e.apply(null,arguments),e=function(){};else{var i=Array.prototype.slice.call(arguments,1),a=n.next();i.push(a?o(a):e),r.setImmediate(function(){n.apply(null,i)})}}};o(r.iterator(n))()};var k=function(n,e,t){if(t=t||function(){},i(e))n.map(e,function(n,e){n&&n(function(n){var t=Array.prototype.slice.call(arguments,1);t.length>1||(t=t[0]),e.call(null,n,t)})},t);else{var r={};n.each(f(e),function(n,t){e[n](function(e){var o=Array.prototype.slice.call(arguments,1);o.length>1||(o=o[0]),r[n]=o,t(e)})},function(n){t(n,r)})}};r.parallel=function(n,e){k({map:r.map,each:r.each},n,e)},r.parallelLimit=function(n,e,t){k({map:d(e),each:l(e)},n,t)},r.series=function(n,e){if(e=e||function(){},i(n))r.mapSeries(n,function(n,e){n&&n(function(n){var t=Array.prototype.slice.call(arguments,1);t.length>1||(t=t[0]),e.call(null,n,t)})},e);else{var t={};r.eachSeries(f(n),function(e,r){n[e](function(n){var o=Array.prototype.slice.call(arguments,1);o.length>1||(o=o[0]),t[e]=o,r(n)})},function(n){e(n,t)})}},r.iterator=function(n){var e=function(t){var r=function(){return n.length&&n[t].apply(null,arguments),r.next()};return r.next=function(){return t<n.length-1?e(t+1):null},r};return e(0)},r.apply=function(n){var e=Array.prototype.slice.call(arguments,1);return function(){return n.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var b=function(n,e,t,r){var o=[];n(e,function(n,e){t(n,function(n,t){o=o.concat(t||[]),e(n)})},function(n){r(n,o)})};r.concat=s(b),r.concatSeries=h(b),r.whilst=function(n,e,t){n()?e(function(o){return o?t(o):void r.whilst(n,e,t)}):t()},r.doWhilst=function(n,e,t){n(function(o){if(o)return t(o);var i=Array.prototype.slice.call(arguments,1);e.apply(null,i)?r.doWhilst(n,e,t):t()})},r.until=function(n,e,t){n()?t():e(function(o){return o?t(o):void r.until(n,e,t)})},r.doUntil=function(n,e,t){n(function(o){if(o)return t(o);var i=Array.prototype.slice.call(arguments,1);e.apply(null,i)?t():r.doUntil(n,e,t)})},r.queue=function(e,t){function o(n,e,t,o){return n.started||(n.started=!0),i(e)||(e=[e]),0==e.length?r.setImmediate(function(){n.drain&&n.drain()}):void a(e,function(e){var i={data:e,callback:"function"==typeof o?o:null};t?n.tasks.unshift(i):n.tasks.push(i),n.saturated&&n.tasks.length===n.concurrency&&n.saturated(),r.setImmediate(n.process)})}void 0===t&&(t=1);var u=0,c={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(n,e){o(c,n,!1,e)},kill:function(){c.drain=null,c.tasks=[]},unshift:function(n,e){o(c,n,!0,e)},process:function(){if(!c.paused&&u<c.concurrency&&c.tasks.length){var t=c.tasks.shift();c.empty&&0===c.tasks.length&&c.empty(),u+=1;var r=function(){u-=1,t.callback&&t.callback.apply(t,arguments),c.drain&&c.tasks.length+u===0&&c.drain(),c.process()},o=n(r);e(t.data,o)}},length:function(){return c.tasks.length},running:function(){return u},idle:function(){return c.tasks.length+u===0},pause:function(){c.paused!==!0&&(c.paused=!0,c.process())},resume:function(){c.paused!==!1&&(c.paused=!1,c.process())}};return c},r.priorityQueue=function(n,e){function t(n,e){return n.priority-e.priority}function o(n,e,t){for(var r=-1,o=n.length-1;o>r;){var i=r+(o-r+1>>>1);t(e,n[i])<0?o=i-1:r=i}return r}function u(n,e,u,c){return n.started||(n.started=!0),i(e)||(e=[e]),0==e.length?r.setImmediate(function(){n.drain&&n.drain()}):void a(e,function(e){var i={data:e,priority:u,callback:"function"==typeof c?c:null};n.tasks.splice(o(n.tasks,i,t)+1,0,i),n.saturated&&n.tasks.length===n.concurrency&&n.saturated(),r.setImmediate(n.process)})}var c=r.queue(n,e);return c.push=function(n,e,t){u(c,n,e,t)},delete c.unshift,c},r.cargo=function(n,e){var t=!1,o=[],c={tasks:o,payload:e,saturated:null,empty:null,drain:null,drained:!0,push:function(n,t){i(n)||(n=[n]),a(n,function(n){o.push({data:n,callback:"function"==typeof t?t:null}),c.drained=!1,c.saturated&&o.length===e&&c.saturated()}),r.setImmediate(c.process)},process:function f(){if(!t){if(0===o.length)return c.drain&&!c.drained&&c.drain(),void(c.drained=!0);var r="number"==typeof e?o.splice(0,e):o.splice(0,o.length),i=u(r,function(n){return n.data});c.empty&&c.empty(),t=!0,n(i,function(){t=!1;var n=arguments;a(r,function(e){e.callback&&e.callback.apply(null,n)}),f()})}},length:function(){return o.length},running:function(){return t}};return c};var w=function(n){return function(e){var t=Array.prototype.slice.call(arguments,1);e.apply(null,t.concat([function(e){var t=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[n]&&a(t,function(e){console[n](e)}))}]))}};r.log=w("log"),r.dir=w("dir"),r.memoize=function(n,e){var t={},o={};e=e||function(n){return n};var i=function(){var i=Array.prototype.slice.call(arguments),a=i.pop(),u=e.apply(null,i);u in t?r.nextTick(function(){a.apply(null,t[u])}):u in o?o[u].push(a):(o[u]=[a],n.apply(null,i.concat([function(){t[u]=arguments;var n=o[u];delete o[u];for(var e=0,r=n.length;r>e;e++)n[e].apply(null,arguments)}])))};return i.memo=t,i.unmemoized=n,i},r.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},r.times=function(n,e,t){for(var o=[],i=0;n>i;i++)o.push(i);return r.map(o,e,t)},r.timesSeries=function(n,e,t){for(var o=[],i=0;n>i;i++)o.push(i);return r.mapSeries(o,e,t)},r.seq=function(){var n=arguments;return function(){var e=this,t=Array.prototype.slice.call(arguments),o=t.pop();r.reduce(n,t,function(n,t,r){t.apply(e,n.concat([function(){var n=arguments[0],e=Array.prototype.slice.call(arguments,1);r(n,e)}]))},function(n,t){o.apply(e,[n].concat(t))})}},r.compose=function(){return r.seq.apply(null,Array.prototype.reverse.call(arguments))};var C=function(n,e){var t=function(){var t=this,r=Array.prototype.slice.call(arguments),o=r.pop();return n(e,function(n,e){n.apply(t,r.concat([e]))},o)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return t.apply(this,r)}return t};r.applyEach=s(C),r.applyEachSeries=h(C),r.forever=function(n,e){function t(r){if(r){if(e)return e(r);throw r}n(t)}t()},"undefined"!=typeof module&&module.exports?module.exports=r:"undefined"!=typeof define&&define.amd?define([],function(){return r}):e.async=r}();